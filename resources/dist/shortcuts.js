var Z=Object.create;var F=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var re=Object.getPrototypeOf,te=Object.prototype.hasOwnProperty;var ie=(d,l)=>()=>(l||d((l={exports:{}}).exports,l),l.exports);var ne=(d,l,T,g)=>{if(l&&typeof l=="object"||typeof l=="function")for(let f of ee(l))!te.call(d,f)&&f!==T&&F(d,f,{get:()=>l[f],enumerable:!(g=j(l,f))||g.enumerable});return d};var se=(d,l,T)=>(T=d!=null?Z(re(d)):{},ne(l||!d||!d.__esModule?F(T,"default",{value:d,enumerable:!0}):T,d));var $=ie((fe,M)=>{(function(d,l,T){if(!d)return;for(var g={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},f={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},v={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},_={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},y,m=1;m<20;++m)g[111+m]="f"+m;for(m=0;m<=9;++m)g[m+96]=m.toString();function R(e,r,i){if(e.addEventListener){e.addEventListener(r,i,!1);return}e.attachEvent("on"+r,i)}function x(e){if(e.type=="keypress"){var r=String.fromCharCode(e.which);return e.shiftKey||(r=r.toLowerCase()),r}return g[e.which]?g[e.which]:f[e.which]?f[e.which]:String.fromCharCode(e.which).toLowerCase()}function B(e,r){return e.sort().join(",")===r.sort().join(",")}function H(e){var r=[];return e.shiftKey&&r.push("shift"),e.altKey&&r.push("alt"),e.ctrlKey&&r.push("ctrl"),e.metaKey&&r.push("meta"),r}function N(e){if(e.preventDefault){e.preventDefault();return}e.returnValue=!1}function V(e){if(e.stopPropagation){e.stopPropagation();return}e.cancelBubble=!0}function b(e){return e=="shift"||e=="ctrl"||e=="alt"||e=="meta"}function U(){if(!y){y={};for(var e in g)e>95&&e<112||g.hasOwnProperty(e)&&(y[g[e]]=e)}return y}function X(e,r,i){return i||(i=U()[e]?"keydown":"keypress"),i=="keypress"&&r.length&&(i="keydown"),i}function Y(e){return e==="+"?["+"]:(e=e.replace(/\+{2}/g,"+plus"),e.split("+"))}function L(e,r){var i,c,C,S=[];for(i=Y(e),C=0;C<i.length;++C)c=i[C],_[c]&&(c=_[c]),r&&r!="keypress"&&v[c]&&(c=v[c],S.push("shift")),b(c)&&S.push(c);return r=X(c,S,r),{key:c,modifiers:S,action:r}}function D(e,r){return e===null||e===l?!1:e===r?!0:D(e.parentNode,r)}function h(e){var r=this;if(e=e||l,!(r instanceof h))return new h(e);r.target=e,r._callbacks={},r._directMap={};var i={},c,C=!1,S=!1,q=!1;function P(t){t=t||{};var s=!1,a;for(a in i){if(t[a]){s=!0;continue}i[a]=0}s||(q=!1)}function I(t,s,a,n,u,K){var o,p,w=[],k=a.type;if(!r._callbacks[t])return[];for(k=="keyup"&&b(t)&&(s=[t]),o=0;o<r._callbacks[t].length;++o)if(p=r._callbacks[t][o],!(!n&&p.seq&&i[p.seq]!=p.level)&&k==p.action&&(k=="keypress"&&!a.metaKey&&!a.ctrlKey||B(s,p.modifiers))){var Q=!n&&p.combo==u,W=n&&p.seq==n&&p.level==K;(Q||W)&&r._callbacks[t].splice(o,1),w.push(p)}return w}function A(t,s,a,n){r.stopCallback(s,s.target||s.srcElement,a,n)||t(s,a)===!1&&(N(s),V(s))}r._handleKey=function(t,s,a){var n=I(t,s,a),u,K={},o=0,p=!1;for(u=0;u<n.length;++u)n[u].seq&&(o=Math.max(o,n[u].level));for(u=0;u<n.length;++u){if(n[u].seq){if(n[u].level!=o)continue;p=!0,K[n[u].seq]=1,A(n[u].callback,a,n[u].combo,n[u].seq);continue}p||A(n[u].callback,a,n[u].combo)}var w=a.type=="keypress"&&S;a.type==q&&!b(t)&&!w&&P(K),S=p&&a.type=="keydown"};function E(t){typeof t.which!="number"&&(t.which=t.keyCode);var s=x(t);if(s){if(t.type=="keyup"&&C===s){C=!1;return}r.handleKey(s,H(t),t)}}function G(){clearTimeout(c),c=setTimeout(P,1e3)}function J(t,s,a,n){i[t]=0;function u(k){return function(){q=k,++i[t],G()}}function K(k){A(a,k,t),n!=="keyup"&&(C=x(k)),setTimeout(P,10)}for(var o=0;o<s.length;++o){var p=o+1===s.length,w=p?K:u(n||L(s[o+1]).action);O(s[o],w,n,t,o)}}function O(t,s,a,n,u){r._directMap[t+":"+a]=s,t=t.replace(/\s+/g," ");var K=t.split(" "),o;if(K.length>1){J(t,K,s,a);return}o=L(t,a),r._callbacks[o.key]=r._callbacks[o.key]||[],I(o.key,o.modifiers,{type:o.action},n,t,u),r._callbacks[o.key][n?"unshift":"push"]({callback:s,modifiers:o.modifiers,action:o.action,seq:n,level:u,combo:t})}r._bindMultiple=function(t,s,a){for(var n=0;n<t.length;++n)O(t[n],s,a)},R(e,"keypress",E),R(e,"keydown",E),R(e,"keyup",E)}h.prototype.bind=function(e,r,i){var c=this;return e=e instanceof Array?e:[e],c._bindMultiple.call(c,e,r,i),c},h.prototype.unbind=function(e,r){var i=this;return i.bind.call(i,e,function(){},r)},h.prototype.trigger=function(e,r){var i=this;return i._directMap[e+":"+r]&&i._directMap[e+":"+r]({},e),i},h.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},h.prototype.stopCallback=function(e,r){var i=this;if((" "+r.className+" ").indexOf(" mousetrap ")>-1||D(r,i.target))return!1;if("composedPath"in e&&typeof e.composedPath=="function"){var c=e.composedPath()[0];c!==e.target&&(r=c)}return r.tagName=="INPUT"||r.tagName=="SELECT"||r.tagName=="TEXTAREA"||r.isContentEditable},h.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},h.addKeycodes=function(e){for(var r in e)e.hasOwnProperty(r)&&(g[r]=e[r]);y=null},h.init=function(){var e=h(l);for(var r in e)r.charAt(0)!=="_"&&(h[r]=function(i){return function(){return e[i].apply(e,arguments)}}(r))},h.init(),d.Mousetrap=h,typeof M<"u"&&M.exports&&(M.exports=h),typeof define=="function"&&define.amd&&define(function(){return h})})(typeof window<"u"?window:null,typeof window<"u"?document:null)});var z=se($(),1);function oe({state:d,isDisabled:l,combinations:T,timeout:g}){return{isRecording:!1,recordedSequence:[],currentRecordedKeys:[],recordedCharacterKey:!1,recordTimer:null,mousetrap:null,state:d,initMousetrap(){this.mousetrap||(this.mousetrap=new z.default(this.$el),this.mousetrap.recording=!1)},record(){if(this.isDisabled)return;this.initMousetrap(),this.isRecording=!0,this.recordedSequence=[],this.currentRecordedKeys=[],this.recordedCharacterKey=!1,this.recordTimer&&(clearTimeout(this.recordTimer),this.recordTimer=null),this.mousetrap.recording=!0;let f=this.mousetrap.handleKey,v=this;this.mousetrap.handleKey=function(_,y,m){if(!v.isRecording)return f.apply(this,arguments);v.handleRecordedKey(_,y,m)}},handleRecordedKey(f,v,_){if(_.type==="keydown"){f.length===1&&this.recordedCharacterKey&&this.recordCurrentCombo();for(let y=0;y<v.length;y++)this.recordKey(v[y]);this.recordKey(f)}else _.type==="keyup"&&this.currentRecordedKeys.length>0&&this.recordCurrentCombo()},recordKey(f){this.currentRecordedKeys.includes(f)||(this.currentRecordedKeys.push(f),f.length===1&&(this.recordedCharacterKey=!0))},recordCurrentCombo(){if(this.currentRecordedKeys.length>0){if(this.recordedSequence.push([...this.currentRecordedKeys]),this.currentRecordedKeys=[],this.recordedCharacterKey=!1,this.recordedSequence.length>=T){this.finishRecording();return}this.restartRecordTimer()}},normalizeSequence(f){for(let v=0;v<f.length;v++)f[v].sort((_,y)=>_.length>1&&y.length===1?-1:_.length===1&&y.length>1||_>y?1:-1),f[v]=f[v].join("+")},restartRecordTimer(){this.recordTimer&&clearTimeout(this.recordTimer),this.recordTimer=setTimeout(()=>{this.finishRecording()},g)},stop(){this.isDisabled||this.finishRecording()},finishRecording(){this.isRecording=!1,this.recordTimer&&(clearTimeout(this.recordTimer),this.recordTimer=null),this.mousetrap&&(this.mousetrap.recording=!1),this.recordedSequence.length>0&&(this.normalizeSequence(this.recordedSequence),this.state=this.recordedSequence.filter(f=>f.trim()!=="")),this.currentRecordedKeys=[],this.recordedCharacterKey=!1,this.$el.blur()},destroy(){this.mousetrap&&this.mousetrap.reset(),this.recordTimer&&clearTimeout(this.recordTimer)},init(){this.initMousetrap()},input:{"x-on:focus":"record()","x-on:blur":"stop()"}}}export{oe as default};
